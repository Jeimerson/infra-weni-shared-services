name: Sync with base template repository

on:
  schedule:
    - cron: "0 0 1 * *"
  # manual trigger
  workflow_dispatch:

jobs:
  repo-sync:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        run: |
          git clone https://tonhaoweni:${{ secrets.TOKEN_VCS }}@github.com/${{ github.repository }} .

      - name: Get updates from template
        run: |
          git pull
          git pull https://tonhaoweni:${{ secrets.TOKEN_VCS }}@github.com/weni-ai/infra-weni-template

      - name: Push changes in repository
        run: |
          git config user.name github-actions[bot]
          git config user.email github-actions[bot]@users.noreply.github.com
          git push
